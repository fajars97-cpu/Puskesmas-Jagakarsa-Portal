<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Penampil Bagan SOP</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="appbar">
    <div class="title">
      <img src="../assets/logo-puskesmas.png" alt="Logo Puskesmas Jagakarsa" class="header-logo" />
      <span>PUSKESMAS JAGAKARSA</span>
    </div>
    <a href="../index.html" class="home-btn">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9.75L12 4l9 5.75M4.5 10.5v9.75h5.25V15h4.5v5.25H19.5V10.5" />
      </svg>
      Home
    </a>
  </header>

  <div class="container">
    <aside class="sidebar">
      <div class="judul-logo">
        <img src="../assets/logo-sayur-sop.png" alt="Logo Sayur SOP" />
        <span>SAYUR SOP</span>
      </div>

      <input type="text" id="searchInput" placeholder="üîé Cari SOP..." />
      <button id="btnCari">Cari</button>

      <select id="kategori-select">
        <option value="">-- Pilih Kategori --</option>
        <option value="klaster1">Klaster 1</option>
        <option value="klaster2">Klaster 2</option>
        <option value="klaster3">Klaster 3</option>
        <option value="klaster4">Klaster 4</option>
        <option value="klaster5">Klaster 5</option>
      </select>

      <select id="sop-select">
        <option value="">-- Pilih SOP --</option>
      </select>
    </aside>

    <main class="content-col">
      <section id="dashboard-stats"></section>
      <section class="main-content" id="messages">
        <p>üì• Pilih SOP dari sebelah kiri untuk menampilkan bagan alir.</p>
      </section>
    </main>
  </div>

  <footer>
    <div class="footer-content">
      <p>&copy; 2025 Puskesmas Jagakarsa</p>
      <div class="social-links">
        <a href="https://api.whatsapp.com/send/?phone=6281389685271" target="_blank">WhatsApp</a>
        <a href="https://www.youtube.com/channel/UC6inZ3DXzmX_ha-Sc8j3qgA/featured" target="_blank">YouTube</a>
        <a href="https://www.tiktok.com/@pkmjagakarsa" target="_blank">TikTok</a>
        <a href="https://www.facebook.com/pkmjagakarsa" target="_blank">Facebook</a>
        <a href="https://x.com/pkmjagakarsa" target="_blank">X</a>
        <a href="https://www.instagram.com/pkmjagakarsa/" target="_blank">Instagram</a>
      </div>
      <p>Alamat: Jl. Masjid Al Afiah, RT.1/RW.2, Jagakarsa, Kec. Jagakarsa, Kota Jakarta Selatan, DKI Jakarta 12620</p>
    </div>
  </footer>

  <script>
  const SOP_DATA = {
    klaster1: [
      { value: 'kamar', text: 'Pembersihan Kamar Mandi', img: '../assets/bagan_alir_pembersihan_kamar_mandi.png' },
      { value: 'alat', text: 'Pemeliharaan Alat Kesehatan', img: '../assets/bagan_alir_pemeliharaan_alat_kesehatan.png' },
      { value: 'data', text: 'Pengumpulan, Penyimpanan, Pencarian Data', img: '../assets/bagan_alir_pengumpulan_penyimpanan_pencarian_data.png' },
      { value: 'orientasi', text: 'Orientasi Pegawai ', img: '../assets/infografis_bagan_orientasi_hd.png' }
    ],
    klaster2: [],
    klaster3: [],
    klaster4: [],
    klaster5: []
  };

  const elKategori = document.getElementById('kategori-select');
  const elSop = document.getElementById('sop-select');
  const elMsg = document.getElementById('messages');
  const elSearch = document.getElementById('searchInput');
  const elBtnCari = document.getElementById('btnCari');
  const elStats = document.getElementById('dashboard-stats');

  function renderStats(){
    const labels = { klaster1: 'Klaster 1', klaster2: 'Klaster 2', klaster3: 'Klaster 3', klaster4: 'Klaster 4', klaster5: 'Klaster 5' };
    elStats.innerHTML = '<div style="display:flex;gap:16px;flex-wrap:wrap">' +
      Object.keys(SOP_DATA).map(k=>{
        const count = SOP_DATA[k].length;
        return `<div style="background:#e8f5e9;border:1px solid #b2dfdb;border-radius:10px;padding:12px 16px;min-width:110px;text-align:center">
          <div style="font-weight:700;color:#1b5e20">${count}</div>
          <div style="font-size:12px;color:#388e3c">${labels[k]}</div>
        </div>`;
      }).join('') + '</div>';
  }

  function populateSopByKategori(kategori){
    elSop.innerHTML = '<option value="">-- Pilih SOP --</option>';
    if(!kategori) return;
    SOP_DATA[kategori].forEach(item=>{
      const opt = document.createElement('option');
      opt.value = item.value;
      opt.textContent = item.text;
      elSop.appendChild(opt);
    });
  }

  function tampilkanSOP(){
    const kategori = elKategori.value;
    populateSopByKategori(kategori);
  }

  function showSOP(){
    const kategori = elKategori.value;
    const value = elSop.value;
    if(!kategori || !value){
      elMsg.innerHTML = '<p>üì• Pilih SOP dari sebelah kiri untuk menampilkan bagan alir.</p>';
      return;
    }
    const item = SOP_DATA[kategori].find(i=>i.value===value);
    if(!item){
      elMsg.innerHTML = '<p>‚ùå SOP belum tersedia.</p>';
      return;
    }
    elMsg.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px">
        <h3 style="margin:0;color:#0f766e">${item.text}</h3>
        <a href="${item.img}" download style="font-size:14px;color:#0ea5e9;text-decoration:none">‚¨áÔ∏è Unduh</a>
      </div>
      <img src="${item.img}" alt="Bagan ${item.text}" style="max-width:100%;height:auto;border:1px solid #ddd;border-radius:8px;background:#fff"/>
    `;
  }

  function cariSOP(){
    const q = elSearch.value.trim().toLowerCase();
    if(!q){ tampilkanSOP(); return; }
    elSop.innerHTML = '<option value="">-- Pilih SOP --</option>';
    Object.keys(SOP_DATA).forEach(kl=>{
      SOP_DATA[kl].forEach(item=>{
        if(item.text.toLowerCase().includes(q)){
          const opt = document.createElement('option');
          opt.value = `${kl}::${item.value}`;
          opt.textContent = `${item.text} (${kl.replace('klaster','Klaster ')})`;
          elSop.appendChild(opt);
        }
      });
    });
  }

  elKategori.addEventListener('change', tampilkanSOP);
  elSop.addEventListener('change', function(){
    const v = elSop.value;
    if(v.includes('::')){
      const [kl, val] = v.split('::');
      elKategori.value = kl;
      populateSopByKategori(kl);
      elSop.value = val;
    }
    showSOP();
  });
  elSearch.addEventListener('input', cariSOP);
  elBtnCari.addEventListener('click', ()=>{
    if(elSop.options.length > 1){ elSop.selectedIndex = 1; elSop.dispatchEvent(new Event('change')); }
  });

  renderStats();
  elKategori.value = 'klaster1';
  tampilkanSOP();
  </script>
</body>
</html>
