<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Penampil Bagan SOP</title>
  <style>
    body{margin:0;font-family:'Segoe UI',Arial,sans-serif;background:#f4f8f9;color:#333}
    header.appbar{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(90deg,#1abc9c,#16a085);padding:12px 20px;color:#fff;box-shadow:0 2px 10px rgba(0,0,0,.15)}
    .header-logo{height:60px;border-radius:6px}
    .title{font-size:1.3rem;font-weight:700;display:flex;align-items:center;gap:12px;letter-spacing:.5px}
    .home-btn{display:flex;align-items:center;gap:8px;text-decoration:none;background:#fff;color:#16a085;padding:8px 18px;border-radius:50px;font-weight:700;box-shadow:0 4px 12px rgba(0,0,0,.15);transition:.3s}
    .home-btn svg{width:22px;height:22px}
    .home-btn:hover{background:#ecf0f1;transform:translateY(-3px);box-shadow:0 6px 15px rgba(0,0,0,.25)}
    .container{display:flex;min-height:calc(100vh - 80px)}
    .sidebar{background:#eaf5f3;padding:20px;width:300px;border-right:1px solid #ccc}
    .judul-logo{display:flex;align-items:center;gap:10px;margin-bottom:20px;font-weight:700;font-size:1.1rem}
    .judul-logo img{height:48px;border-radius:6px}
    input,select,button{width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;font-size:.95rem;transition:border-color .3s,box-shadow .3s}
    input:focus,select:focus{border-color:#1abc9c;box-shadow:0 0 5px rgba(26,188,156,.5);outline:none}
    button{background:#1abc9c;color:#fff;border:none;cursor:pointer;font-weight:700}
    button:hover{background:#16a085}
    main.content-col{flex:1;padding:20px}
    .main-content{background:#fff;border-radius:10px;padding:20px;box-shadow:0 3px 8px rgba(0,0,0,.1);min-height:300px;transition:box-shadow .3s}
    .main-content:hover{box-shadow:0 5px 15px rgba(0,0,0,.15)}
    .main-content img{max-width:100%;border-radius:8px}
    footer{background:linear-gradient(90deg,#1abc9c,#16a085);color:#fff;text-align:center;padding:15px;font-size:.9rem}
    footer a{color:#fff;text-decoration:underline}
  </style>
</head>
<body>
  <header class="appbar">
    <div class="title">
      <!-- SOP berada di /sop/, aset berada di /assets/ ‚Üí gunakan ../assets/... -->
      <img src="../assets/logo_puskesmas.png" alt="Logo Puskesmas Jagakarsa" class="header-logo" />
      <span>PUSKESMAS JAGAKARSA</span>
    </div>
    <a href="../index.html" class="home-btn" aria-label="Kembali ke Landing Page">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9.75L12 4l9 5.75M4.5 10.5v9.75h5.25V15h4.5v5.25H19.5V10.5"/></svg>
      Home
    </a>
  </header>

  <div class="container">
    <aside class="sidebar">
      <div class="judul-logo">
        <img src="../assets/logo_sayur_sop.png" alt="Logo Sayur Sop" />
        <span>SAYUR SOP</span>
      </div>

      <input type="text" id="searchInput" placeholder="üîé Cari SOP..." />
      <button id="btnCari">Cari</button>

      <select id="kategori-select">
        <option value="">-- Pilih Kategori --</option>
        <option value="klaster1">Klaster 1</option>
        <option value="klaster2">Klaster 2</option>
        <option value="klaster3">Klaster 3</option>
        <option value="klaster4">Klaster 4</option>
        <option value="klaster5">Klaster 5</option>
      </select>

      <select id="sop-select">
        <option value="">-- Pilih SOP --</option>
      </select>
    </aside>

    <main class="content-col">
      <section id="dashboard-stats"></section>
      <section class="main-content" id="messages">
        <p>üì• Pilih SOP dari sebelah kiri untuk menampilkan bagan alir.</p>
      </section>
    </main>
  </div>

  <footer>
    <p>&copy; 2025 Puskesmas Jagakarsa | Hubungi kami: <a href="https://api.whatsapp.com/send/?phone=6281389685271">WhatsApp</a></p>
  </footer>

  <script>
    // ===== Data SOP (aset berada di ../assets dari folder /sop) =====
    const SOP_DATA = {
      klaster1: [
        { value: 'kamar',     text: 'Pembersihan Kamar Mandi',                       img: '../assets/bagan_alir_pembersihan_kamar_mandi.png' },
        { value: 'alat',      text: 'Pemeliharaan Alat Kesehatan',                   img: '../assets/bagan_alir_pemeliharaan_alat_kesehatan.png' },
        { value: 'data',      text: 'Pengumpulan, Penyimpanan, Pencarian Data',      img: '../assets/bagan_alir_pengumpulan_penyimpanan_pencarian_data.png' },
        { value: 'orientasi', text: 'Orientasi HD',                                   img: '../assets/infografis_bagan_orientasi_hd.png' }
      ],
      klaster2: [], klaster3: [], klaster4: [], klaster5: []
    };

    const elKategori = document.getElementById('kategori-select');
    const elSop      = document.getElementById('sop-select');
    const elMsg      = document.getElementById('messages');
    const elSearch   = document.getElementById('searchInput');
    const elBtnCari  = document.getElementById('btnCari');
    const elStats    = document.getElementById('dashboard-stats');

    function renderStats(){
      const labels = { klaster1:'Klaster 1', klaster2:'Klaster 2', klaster3:'Klaster 3', klaster4:'Klaster 4', klaster5:'Klaster 5' };
      elStats.innerHTML = '<div style="display:flex;gap:14px;flex-wrap:wrap">' +
        Object.keys(SOP_DATA).map(k => (
          `<div style="background:#e8f5e9;border:1px solid #b2dfdb;border-radius:10px;padding:10px 14px;min-width:110px;text-align:center">
             <div style="font-weight:700;color:#1b5e20">${SOP_DATA[k].length}</div>
             <div style="font-size:12px;color:#388e3c">${labels[k]}</div>
           </div>`
        )).join('') + '</div>';
    }

    function populateSopByKategori(kategori){
      elSop.innerHTML = '<option value="">-- Pilih SOP --</option>';
      if(!kategori) return;
      SOP_DATA[kategori].forEach(item => {
        const opt = document.createElement('option');
        opt.value = item.value;
        opt.textContent = item.text;
        elSop.appendChild(opt);
      });
    }

    function resetMessage(){
      elMsg.innerHTML = '<p>üì• Pilih SOP dari sebelah kiri untuk menampilkan bagan alir.</p>';
    }

    function tampilkanSOP(){
      populateSopByKategori(elKategori.value);
      resetMessage();
    }

    function showSOP(){
      const kategori = elKategori.value;
      const value    = elSop.value;
      if(!kategori || !value){ resetMessage(); return; }
      const item = SOP_DATA[kategori].find(i => i.value === value);
      if(!item){ elMsg.innerHTML = '<p>‚ùå SOP belum tersedia.</p>'; return; }
      elMsg.innerHTML = `
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:10px">
          <h3 style="margin:0;color:#0f766e">${item.text}</h3>
          <a href="${item.img}" download style="font-size:14px;color:#0ea5e9;text-decoration:none">‚¨áÔ∏è Unduh</a>
        </div>
        <img src="${item.img}" alt="Bagan ${item.text}">
      `;
    }

    // Pencarian responsif (live)
    function searchLive(){
      const q = (elSearch.value||'').toLowerCase().trim();
      if(!q){ tampilkanSOP(); return; }
      elSop.innerHTML = '<option value="">-- Pilih SOP --</option>';
      let first; let firstKlaster;
      Object.keys(SOP_DATA).forEach(kl => {
        SOP_DATA[kl].forEach(item => {
          if(item.text.toLowerCase().includes(q)){
            if(!first){ first = item.value; firstKlaster = kl; }
            const opt = document.createElement('option');
            opt.value = item.value;
            opt.textContent = `${item.text} (${kl.replace('klaster','Klaster ')})`;
            elSop.appendChild(opt);
          }
        });
      });
      if(first){ elKategori.value = firstKlaster; elSop.value = first; showSOP(); }
      else{ elMsg.innerHTML = '<p>üîç Tidak ada SOP yang cocok.</p>'; }
    }

    // Init & events
    renderStats();
    elKategori.value = 'klaster1';
    tampilkanSOP();
    elKategori.addEventListener('change', tampilkanSOP);
    elSop.addEventListener('change', showSOP);
    elBtnCari.addEventListener('click', searchLive);
    elSearch.addEventListener('input', searchLive);
  </script>
</body>
</html>
